---
title: "Astro on Cloudflare Using Automated Git Workflows"
slug: astro-on-cloudflare-using-automated-git-workflows
excerpt: "Automate your Astro site deployment to Cloudflare Pages using Git workflow automation"
created_date: 2024-11-14
status: published
coverimage: "astro-cloudflare-pages-workflow.png"
vendor_name: "Cloudflare"
horizontal_logo: "cloudflare-horizontal-logo.svg"
vendoricon: "cloudflare-favicon.svg"
tags: ["astro", "cloudflare", "git", "automation"]
category: "DevOps"
---

## Overview

Cloudflare Pages is a powerful platform for hosting static sites - edge caching, image manipulation, page rules and with some configuration, server-side rendering. If you're an Astro user, you can automate the build and deployment process using Git workflow automation. If your site is pure static, you can configure everything in just a few clicks.

If you site includes server-side rendered pages it's a bit more work to get things properly configured, but once set up it works flawlessly and the site's performance is blisteringly fast.

In this post I cover the process for automating both static and server-side rendered (hybrid) sites and highlight some of the gotchas I bumped into when setting this site up on Cloudflare Pages.

### Static, Client-Side Rendering and Server-Side Rendering

## Automating a Static-Only Astro Build with Cloudflare Pages and Github

1. Create Pages project
2. Add Cloudflare Astro plugin
3. Configure Git repository
4. Set up build and deployment settings
5. Push Astro code to repository

### Add Cloudflare Astro plugin

This step is optional if you're generating static content only. If you're using server-side rendering, you'll need to add the Cloudflare plugin.

```bash caption="Install Cloudflare Astro plugin"
npm install @astrojs/cloudflare
```

### Configure Git repository

There's very little involved in this step as Cloudflare now authenticates with GitHub and pulls the repository info over after you've granted permission. Simply select the repository you want to deploy from and you're good to go.

### Set up build and deployment settings

You need to select the package manager you use locally to ensure the package lock file is generated correctly. I use Bun, so for me it was `bun run build` as the build command using the main branch of the repository. The steps are pretty much identical for the other package managers (npm, pnpm, yarn, etc.).

Select a push action as the trigger for the workflow so the site is redeployed each time a change is made.

### Push Astro code to repository

```bash caption="Push Astro code to repository"
git add .
git commit -m "Deploy Astro site to Cloudflare Pages"
git push
```

You can watch the build process in the Cloudflare dashboard. You may find it fails to build even though it completes locally. I found I had to remove some files that were prefixed with an underscore (ignored by Astro) as it was trying to build them. After that you should able to access your site using the URL entered in the Cloudflare dashboard when you created the project.
