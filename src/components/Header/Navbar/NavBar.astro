---
import RootItem from '@components/Header/Navbar/RootItem.astro';
import SubMenuItem from '@components/Header/Navbar/SubMenuItem.astro';
import LogoIcon from '@components/Header/Navbar/LogoIcon.astro';
import AccountCircleIcon from '@components/Icons/AccountCircleIcon.astro';
import IdentityIcon from '@components/Icons/IdentityIcon.astro';
import FaceIcon from '@components/Icons/FaceIcon.astro';
import NewspaperIcon from '@components/Icons/NewspaperIcon.astro';
import ServerIcon from '@components/Icons/ServerIcon.astro';
import EditorChoiceIcon from '@components/Icons/EditorChoiceIcon.astro';
import KanbanIcon from '@icons/KanbanIcon.astro';
import SystemsIcon from '@icons/ServerIcon.astro';
import WebDevelopmentIcon from '@icons/WebDevelopmentIcon.astro';
import SoftwareDevelopmentIcon from '@icons/SoftwareDevelopmentIcon.astro';
import NetworkingIcon from '@icons/NetworkingIcon.astro';
import HireMeIcon from '@icons/HireMeIcon.astro';
import StorageIcon from '@icons/StorageIcon.astro';
import SysAdminIcon from '@icons/SysAdminIcon.astro';
import AIIcon from '@icons/Robot2Icon.astro';
import DatabaseIcon from '@icons/DatabaseIcon.astro';
import BriefcaseIcon from '@icons/BriefcaseIcon.astro';
const menuStructure = {
  tech: {
    root: '/tech',
    pathMatch: '/tech/'
  },
  about: {
    root: '/me',
    pathMatch: '/me/'
  },
  blog: {
    root: '/blog',
    pathMatch: '/blog/'
  },
  hireme: {
    root: '/hire-me',
    pathMatch: '/hire-me/'
  }
};

const currentPath = Astro.url.pathname; 
const isActiveRoute = (menuItem: keyof typeof menuStructure) => {
  return currentPath === menuStructure[menuItem].root || currentPath.startsWith(menuStructure[menuItem].pathMatch);
};

const getIsActive = (menuItem: keyof typeof menuStructure) => {
  return isActiveRoute(menuItem);
};

const iconClasses = (menuItem: keyof typeof menuStructure) => [
  "w-10 h-10 md:w-[18px] md:h-[18px] fill-black dark:fill-gray-200 hover:fill-purple-900 group-hover/item:fill-purple-900 mr-2",
  getIsActive(menuItem) && "fill-black hover:fill-purple-900 dark:fill-gray-200 dark:hover:fill-purple-900"
];

const rootIconClasses = (menuItem: keyof typeof menuStructure) => [
  "w-10 h-10 md:w-[18px] md:h-[18px] fill-black dark:fill-gray-200 group-hover:fill-purple-900 group-hover/button:fill-purple-900",
  getIsActive(menuItem) && "fill-white hover:fill-purple-900 dark:fill-gray-200 dark:hover:fill-purple-900"
];
---



<nav>
    <div class={`md:flex-row gap-0 space-y-0 flex flex-grow flex-col items-center justify-between w-full max-w-lg border-[#c8c9cc] dark:border-neutral-800 border my-0 md:rounded-t-none md:rounded-b-lg md:mb-0 bg-white dark:bg-background
  mx-auto py-3 px-3
  sm:px-4 sm:text-lg
  md:h-24 md:max-h-16 md:min-h-16 md:px-4
  lg:h-28
  2xl:max-w-2xl`}>
      <div class="flex items-center shrink-0">
        <LogoIcon class="w-[24px] h-[24px]"/>
        <a href="/" class="mr-4 cursor-pointer py-1.5 text-2xl text-gray-700 dark:text-gray-200 font-semibold">
          SimonGreer.co.uk
        </a>
      </div>
      


      <div id="navbar-default" 
          class="items-center flex-grow gap-x-1 justify-end hidden md:flex w-full p-0 m-0 mt-16 md:mt-0 dark:bg-background bg-white absolute top-0 h-[100vh] min-h-[100vh] md:min-h-full md:top-0 md:relative md:visible md:w-auto md:h-full">
          <RootItem isActive={isActiveRoute('blog')} link="/blog" label="Blog Posts">
            <NewspaperIcon 
              class:list={rootIconClasses('blog')}
            />
            Blog Posts
          </RootItem>
            <!-- <RootItem isActive={isActiveRoute('tech')} link="/tech" label="Tech Stuff">
              <ServerIcon class:list={rootIconClasses('tech')}/>
              Tech Stuff
              <Fragment slot="submenu">
                <SubMenuItem link="/tech/skills-and-expertise" isFirst={true}>
                  <KanbanIcon class:list={iconClasses('tech')}/>Skills and Experience
                </SubMenuItem>
                <SubMenuItem link="/tech/projects" isLast={true}>
                  <EditorChoiceIcon class:list={iconClasses('tech')}/>Projects
                </SubMenuItem>
              </Fragment>
            </RootItem> -->
            <RootItem isActive={isActiveRoute('hireme')} link="/hire-me" label="Hire Me">
              <HireMeIcon class:list={rootIconClasses('hireme')}/>
              Hire Me
              <Fragment slot="submenu">
              <SubMenuItem link="/hire-me/web-development" isFirst={true}>
                <WebDevelopmentIcon class:list={iconClasses('hireme')}/>
                Web Development
              </SubMenuItem>
              <SubMenuItem link="/hire-me/software-development">
                <SoftwareDevelopmentIcon class:list={iconClasses('hireme')}/>
                Software Development
              </SubMenuItem>
              <SubMenuItem link="/hire-me/business-apps">
                <BriefcaseIcon class:list={iconClasses('hireme')} class="fill-white" fill="#ffffff" />
                Business Apps
              </SubMenuItem>
              <SubMenuItem link="/hire-me/networking-and-security">
                <NetworkingIcon class:list={iconClasses('hireme')}/>
                Networking, Security, VPNs
              </SubMenuItem>
              <SubMenuItem link="/hire-me/system-administration">
                <SysAdminIcon class:list={iconClasses('hireme')}/>
                SysAdmin
              </SubMenuItem>
              <SubMenuItem link="/hire-me/system-design-and-deployment">
                <SystemsIcon class:list={iconClasses('hireme')}/>
                System Deployment
              </SubMenuItem>
              <SubMenuItem link="/hire-me/data-and-databases">
                <DatabaseIcon class:list={iconClasses('hireme')}/>
                Data &amp; Databases
              </SubMenuItem>
              <SubMenuItem link="/hire-me/storage-and-nas" isLast={true}>
                <StorageIcon class:list={iconClasses('hireme')}/>
                Storage, NAS
              </SubMenuItem>
              </Fragment>
            </RootItem>
            <RootItem isActive={isActiveRoute('about')} link="/me" label="About Me">
              <AccountCircleIcon 
                class:list={rootIconClasses('about')}
              />
              About Me
            </RootItem>
      </div>
      

  <div class="block pr-6 md:hidden">
    <button id="mobile-menu-button" type="button" class="flex items-center m-1 p-2 w-12 h-12 justify-center text-black rounded-lg md:hidden hover:bg-white md:hover:bg-blue-800 hover:text-blue-800 focus:outline-none focus:ring-2 focus:ring-gray-200 absolute right-2 top-1 z-50" aria-controls="navbar-default" aria-expanded="false">
      <span class="sr-only">Open main menu</span>
      <svg class="h-full aspect-w-1 aspect-h-1" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 17 14">
          <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 1h15M1 7h15M1 13h15"/>
      </svg>
    </button>
  </div>


<script>
  document.addEventListener('astro:page-load', () => {
    const button = document.getElementById('mobile-menu-button');
    const menu = document.getElementById('navbar-default');
    
    if (button && menu) {
      button.addEventListener('click', () => {
        menu.classList.toggle('hidden');
      });
    }
  });
</script>

</nav>



