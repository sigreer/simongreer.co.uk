---
import { getEntry, render } from 'astro:content';
import { Image } from 'astro:assets';
const { post } = Astro.props;
const entry = await getEntry('blog', post.id);
import type { ImageMetadata } from 'astro';
const allImages = import.meta.glob<{ default: ImageMetadata }>('../images/covers/*', { eager: true });
const ImageSrc = entry?.data.coverimage ? allImages[`../images/covers/${entry.data.coverimage}`]?.default : null;
const formattedDate = new Date(post.data.created_date).toLocaleDateString('en-GB', {
  day: '2-digit',
  month: '2-digit',
  year: '2-digit'
});
---
  {ImageSrc && (
    <a href={`/blog/${post.id}`} class="block relative min-w-[1024px] max-h-[40vh] items-center overflow-hidden rounded-b-lg border-gray-800 border drop-shadow-lg rounded-lg bg-blue-900">
      <Image 
        src={ImageSrc} 
        alt={post.data.title ?? 'Nice cover image'} 
        width={1200} 
        height={600} 
        format="webp"
        class="w-full h-full p-0 mt-0 rounded-none"
        loading="lazy"
      />
      <div class="absolute bottom-4 left-4 prose-h1:text-white prose-h1:!text-3xl prose-h1:font-bold [text-shadow:0px_1px_8px_rgb(0_0_0/_0.7)] prose-h1:no-underline px-4 drop-shadow-[0px_1px_3px_rgb(0_0_0/_0.8)]">
        <h1>{post.data.title}</h1>
      </div>
      <div class="absolute top-4 left-4 prose-h3:text-pink-400 prose-h3:text-3xl prose-h3:font-bold prose-h3:no-underline px-4">
        <h3>{formattedDate}</h3>
      </div>
    </a>
  )}